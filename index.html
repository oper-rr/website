<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MERCURY ECHO // AI + VFX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://api.fontshare.com/v2/css?f[]=clash-display@200,400,700,900&f[]=ibm-plex-mono@100,400,700&display=swap');

        :root {
            --bg: #000000;
            --chrome: #e2e2e2;
            --accent: #ffffff;
        }

        body {
            background-color: var(--bg);
            color: #fff;
            font-family: 'IBM Plex Mono', monospace;
            margin: 0;
            overflow: hidden;
            cursor: none;
        }

        .font-clash { font-family: 'Clash Display', sans-serif; }

        canvas#vfx-canvas {
            position: fixed;
            inset: 0;
            z-index: 1;
        }

        /* HUD Layers */
        .hud-overlay {
            position: fixed;
            inset: 0;
            z-index: 100;
            pointer-events: none;
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .hud-data {
            font-size: 10px;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            opacity: 0.4;
        }

        /* Perspective Container */
        #stage {
            position: fixed;
            inset: 0;
            z-index: 10;
            perspective: 2000px;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .echo-node {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            pointer-events: auto;
            will-change: transform, opacity, filter;
        }

        .echo-title {
            font-family: 'Clash Display', sans-serif;
            font-weight: 900;
            font-size: clamp(3rem, 15vw, 20rem);
            line-height: 0.8;
            letter-spacing: -0.06em;
            text-transform: uppercase;
            text-align: center;
            color: #fff;
            transition: color 0.3s;
        }

        .echo-title span {
            display: block;
            -webkit-text-stroke: 1px rgba(255,255,255,0.2);
            color: transparent;
        }

        .echo-node:hover .echo-title span {
            color: #fff;
            -webkit-text-stroke: 1px transparent;
        }

        .echo-meta {
            font-size: 11px;
            letter-spacing: 0.8em;
            text-transform: uppercase;
            margin-top: 2rem;
            opacity: 0.3;
        }

        /* Custom Cursor */
        #cursor {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #fff;
            border-radius: 50%;
            z-index: 1000;
            pointer-events: none;
            mix-blend-mode: difference;
        }

        #cursor-ring {
            position: fixed;
            width: 50px;
            height: 50px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            z-index: 999;
            pointer-events: none;
            transition: transform 0.1s ease;
        }

        /* Progress Tracker */
        .progress-track {
            position: fixed;
            left: 3rem;
            top: 50%;
            transform: translateY(-50%);
            height: 200px;
            width: 1px;
            background: rgba(255,255,255,0.1);
            z-index: 100;
        }

        .progress-bar {
            width: 100%;
            background: #fff;
            height: 0%;
            box-shadow: 0 0 10px #fff;
        }

        .film-grain {
            position: fixed;
            inset: 0;
            background: url('https://grainy-gradients.vercel.app/noise.svg');
            opacity: 0.05;
            z-index: 200;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="film-grain"></div>
    <div id="cursor"></div>
    <div id="cursor-ring"></div>
    
    <canvas id="vfx-canvas"></canvas>

    <!-- UI: HUD -->
    <div class="hud-overlay">
        <div class="flex justify-between items-start">
            <div class="hud-data">
                SYSTEM // MERCURY_ECHO<br/>
                MODEL_TYPE: AI_VFX_TRAINER
            </div>
            <div class="text-right hud-data">
                LATENT_LOC: <span id="depth-val" class="text-white">0</span>.00<br/>
                STATUS: SYNCED
            </div>
        </div>

        <div class="flex justify-between items-end">
            <div class="hud-data">
                [X] <span id="mouse-x">0</span><br/>
                [Y] <span id="mouse-y">0</span>
            </div>
            <div class="flex gap-12 pointer-events-auto">
                <a href="#" class="hud-data hover:text-white transition-opacity">Archive</a>
                <a href="#" class="hud-data hover:text-white transition-opacity">Nexus</a>
            </div>
        </div>
    </div>

    <div class="progress-track">
        <div class="progress-bar" id="p-bar"></div>
    </div>

    <!-- The 3D Tunnel -->
    <main id="stage">
        <!-- Frame 01 -->
        <div class="echo-node" data-z="0">
            <div class="echo-meta">// INITIAL STATE</div>
            <h2 class="echo-title">MERCURY<span>ECHO</span></h2>
        </div>

        <!-- Frame 02 -->
        <div class="echo-node" data-z="-2000">
            <div class="echo-meta">// PROJECT_01</div>
            <h2 class="echo-title">NEURAL<span>DREAMS</span></h2>
        </div>

        <!-- Frame 03 -->
        <div class="echo-node" data-z="-4000">
            <div class="echo-meta">// PROJECT_02</div>
            <h2 class="echo-title">VOX<span>FLUID</span></h2>
        </div>

        <!-- Frame 04 -->
        <div class="echo-node" data-z="-6000">
            <div class="echo-meta">// PROJECT_03</div>
            <h2 class="echo-title">LATENT<span>OS</span></h2>
        </div>

        <!-- Frame 05 -->
        <div class="echo-node" data-z="-8000">
            <div class="echo-meta">// CONTACT</div>
            <h2 class="echo-title">ESTABLISH<span>SYNC</span></h2>
        </div>
    </main>

    <!-- VFX Warp Shader -->
    <script id="vertexShader" type="x-shader/x-vertex">
        varying vec2 vUv;
        void main() {
            vUv = uv;
            gl_Position = vec4(position, 1.0);
        }
    </script>

    <script id="fragmentShader" type="x-shader/x-fragment">
        precision highp float;
        uniform float uTime;
        uniform vec2 uResolution;
        uniform float uScrollSpeed;
        varying vec2 vUv;

        float rand(vec2 n) { 
            return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);
        }

        void main() {
            vec2 uv = gl_FragCoord.xy / uResolution.xy;
            vec2 centeredUv = uv - 0.5;
            
            float dist = length(centeredUv);
            // Warp intensity based on scroll speed
            float warp = pow(dist, 2.0) * uScrollSpeed * 1.5;
            vec2 warpedUv = uv + centeredUv * warp;
            
            // Procedural Chromatic Aberration
            // Shift the coordinates for each channel based on scroll speed
            float shift = uScrollSpeed * 0.02;
            
            float r_noise = rand(warpedUv + vec2(shift, 0.0) + uTime * 0.005);
            float g_noise = rand(warpedUv + uTime * 0.005);
            float b_noise = rand(warpedUv - vec2(shift, 0.0) + uTime * 0.005);

            // Base gradient
            vec3 baseColor = mix(vec3(0.005), vec3(0.04), dist);
            
            // Add the "chromatic" procedural noise
            vec3 color = baseColor;
            color.r += r_noise * 0.015;
            color.g += g_noise * 0.015;
            color.b += b_noise * 0.015;
            
            // Vignette
            float vignette = smoothstep(1.2, 0.2, dist);
            color *= vignette;

            gl_FragColor = vec4(color, 1.0);
        }
    </script>

    <script>
        // --- CORE ENGINE ---
        const cursor = document.getElementById('cursor');
        const cursorRing = document.getElementById('cursor-ring');
        const nodes = document.querySelectorAll('.echo-node');
        const canvas = document.getElementById('vfx-canvas');
        
        // Three.js Background
        const scene = new THREE.Scene();
        const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
        
        const uniforms = {
            uTime: { value: 0 },
            uResolution: { value: new THREE.Vector2(window.innerWidth, window.innerHeight) },
            uScrollSpeed: { value: 0 }
        };

        const material = new THREE.ShaderMaterial({
            uniforms: uniforms,
            vertexShader: document.getElementById('vertexShader').textContent,
            fragmentShader: document.getElementById('fragmentShader').textContent
        });

        scene.add(new THREE.Mesh(new THREE.PlaneGeometry(2, 2), material));

        function resize() {
            renderer.setSize(window.innerWidth, window.innerHeight);
            uniforms.uResolution.value.set(window.innerWidth, window.innerHeight);
        }
        window.addEventListener('resize', resize);
        resize();

        // --- INTERACTION ---
        let scrollZ = 0, targetScrollZ = 0, scrollSpeed = 0;

        document.addEventListener('mousemove', (e) => {
            gsap.to(cursor, { x: e.clientX, y: e.clientY, duration: 0 });
            gsap.to(cursorRing, { x: e.clientX - 25, y: e.clientY - 25, duration: 0.2 });
            document.getElementById('mouse-x').innerText = e.clientX;
            document.getElementById('mouse-y').innerText = e.clientY;
        });

        window.addEventListener('wheel', (e) => {
            targetScrollZ -= e.deltaY * 2.5;
            // Clamping range
            targetScrollZ = Math.min(0, Math.max(targetScrollZ, -8500));
        });

        // --- ANIMATION LOOP ---
        function animate(time) {
            uniforms.uTime.value = time * 0.001;

            // Interpolate Z-Scroll
            const prevZ = scrollZ;
            scrollZ += (targetScrollZ - scrollZ) * 0.06;
            scrollSpeed = Math.abs(scrollZ - prevZ);
            
            // Update UI
            document.getElementById('depth-val').innerText = Math.floor(Math.abs(scrollZ));
            document.getElementById('p-bar').style.height = (Math.abs(scrollZ) / 8500 * 100) + "%";
            uniforms.uScrollSpeed.value = scrollSpeed * 0.05;

            // Transform Nodes
            nodes.forEach(node => {
                const baseZ = parseFloat(node.getAttribute('data-z'));
                const relativeZ = baseZ - scrollZ;
                
                let opacity = 1;
                if (relativeZ > 0) {
                    opacity = 1 - (relativeZ / 500); // Pass camera and fade out
                } else {
                    opacity = 1 - (Math.abs(relativeZ) / 3000); // Fade from distance
                }

                const scale = 1 + (relativeZ / 1000);
                const blur = Math.abs(relativeZ) / 200;

                gsap.set(node, {
                    z: relativeZ,
                    opacity: opacity < 0 ? 0 : opacity,
                    filter: `blur(${blur}px)`,
                    display: relativeZ > 600 || relativeZ < -5000 ? 'none' : 'flex'
                });
            });

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }
        requestAnimationFrame(animate);

        lucide.createIcons();
    </script>
</body>
</html>
